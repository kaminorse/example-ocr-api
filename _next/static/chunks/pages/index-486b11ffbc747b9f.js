(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(3399)}])},3399:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var i=a(5893),n=a(6154),r={WebApiEndpoint:"./api/",AUTHORIZATION_HEADER_NAME:"Authorization",XSRF_HEADER_NAME:"X-XSRF-TOKEN",XSRF_COOKIE_NAME:"XSRF-TOKEN"};let s={baseURL:r.WebApiEndpoint,timeout:3e5,headers:{"Content-Type":"application/json;charset=utf-8"},transformResponse:(e,t)=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(e)}return e}},d=Object.assign(s,{xsrfHeaderName:r.XSRF_HEADER_NAME,xsrfCookieName:r.XSRF_COOKIE_NAME,withCredentials:!0}),l=e=>e,h=n.Z.create(s),o=n.Z.create(d);h.interceptors.response.use(e=>l(e)),o.interceptors.request.use(e=>e),o.interceptors.response.use(e=>l(e),e=>Promise.reject(e));var c={plainInstance:h,securedInstance:o},u=a(7294);function g(){let[e,t]=(0,u.useState)(""),[a,n]=(0,u.useState)(""),[r,s]=(0,u.useState)(""),[d,l]=(0,u.useState)(127);return(0,u.useEffect)(()=>{let t=document.getElementById("original-image-canvas");if(!t)return;let a=t.getContext("2d"),i=new Image;i.src=e,i.onload=()=>{t.width=i.width,t.height=i.height,a&&i&&a.drawImage(i,0,0,i.width,i.height);let e=document.getElementById("binarized-image-canvas");if(!e)return;e.width=i.width,e.height=i.height;let n=e.getContext("2d");if(!n)return;let r=n.createImageData(i.width,i.height);if(a){let e=a.getImageData(0,0,i.width,i.height);for(let t=0;t<i.height;t++)for(let a=0;a<i.width;a++){let n=4*(t*i.width+a),s=e.data[n],l=e.data[n+1],h=e.data[n+2],o=e.data[n+3],c=.299*s+.587*l+.144*h;c>d?(r.data[n]=255,r.data[n+1]=255,r.data[n+2]=255,r.data[n+3]=o):(r.data[n]=0,r.data[n+1]=0,r.data[n+2]=0,r.data[n+3]=o)}n.putImageData(r,0,0)}}},[e,d]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files){let a=e.target.files[0],i=new FileReader;i.onload=e=>{t(i.result?i.result:"")},i.readAsDataURL(a)}}})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"original-image-canvas",children:"元画像"}),(0,i.jsx)("div",{children:(0,i.jsx)("canvas",{id:"original-image-canvas",width:900,height:450})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"original-image-canvas",children:"2値化"}),(0,i.jsx)("div",{children:(0,i.jsx)("canvas",{id:"binarized-image-canvas",width:900,height:450})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{htmlFor:"threshold",children:"Threshold"}),(0,i.jsx)("input",{type:"range",id:"threshold",name:"threshold",min:"0",max:"255",value:d,onChange:e=>{l(e.target.valueAsNumber)}})]}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{onClick:()=>{if(!e)return;let t=document.getElementById("binarized-image-canvas");t&&c.plainInstance.post("/example",{payload:{image:t.toDataURL()}}).then(e=>{e.data.payload.tsv&&n(e.data.payload.tsv),e.data.payload.text&&s(e.data.payload.text)})},children:"Submit"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"TSV"}),(0,i.jsx)("textarea",{value:a,readOnly:!0,style:{width:"100%",minHeight:"6rem"}})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{children:"テキスト"}),(0,i.jsx)("textarea",{value:r,readOnly:!0,style:{width:"100%",minHeight:"6rem"}})]})]})}}},function(e){e.O(0,[154,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);